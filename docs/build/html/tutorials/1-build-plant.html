<!doctype html>
<html class="no-js">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="How to do foo" href="../md/tutorial1.html" /><link rel="prev" title="motornet.task" href="../motornet.task.html" />

    <meta name="generator" content="sphinx-4.5.0, furo 2022.04.07"/>
        <title>Build a plant - MotorNet 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?digest=68f4518137b9aefe99b631505a2064c3c42c9852" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?digest=30d1aed668e5c3a91c3e3bf6a60b675221979f0e" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">MotorNet 1.0.0 documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  
  <span class="sidebar-brand-text">MotorNet 1.0.0 documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder=Search name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Reference Manual</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../motornet.html">MotorNet</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../motornet.nets.html">motornet.nets</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../motornet.nets.callbacks.html">motornet.nets.callbacks</a></li>
<li class="toctree-l3"><a class="reference internal" href="../motornet.nets.layers.html">motornet.nets.layers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../motornet.nets.losses.html">motornet.nets.losses</a></li>
<li class="toctree-l3"><a class="reference internal" href="../motornet.nets.models.html">motornet.nets.models</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../motornet.plants.html">motornet.plants</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../motornet.plants.muscles.html">motornet.plants.muscles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../motornet.plants.skeletons.html">motornet.plants.skeletons</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../motornet.utils.html">motornet.utils</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle child pages in navigation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../motornet.utils.plotor.html">motornet.utils.plotor</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../motornet.task.html">motornet.task</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Tutorials</span></p>
<ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Build a plant</a></li>
<li class="toctree-l1"><a class="reference internal" href="../md/tutorial1.html">How to do foo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nb/testnb.html">Test notebook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../md/tutorial2.html">How to do bar</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../md/install.html">How to install</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container"><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
</style>
<section id="Build-a-plant">
<h1>Build a plant<a class="headerlink" href="#Build-a-plant" title="Permalink to this headline">#</a></h1>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">motornet</span> <span class="k">as</span> <span class="nn">mn</span>

<span class="n">file_dir</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">sys</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">file_dir</span><span class="p">[:</span><span class="n">file_dir</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s1">'tutorials'</span><span class="p">)]))</span>

<span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
<span class="nb">print</span><span class="p">(</span><span class="s1">'</span><span class="se">\n</span><span class="s1">'</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'tensorflow version: '</span> <span class="o">+</span> <span class="n">tf</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">'numpy version: '</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">__version__</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>


tensorflow version: 2.7.0
numpy version: 1.22.2
</pre></div></div>
</div>
<section id="I.-Build-a-basic-plant-with-muscles-wrapped-around-the-skeleton">
<h2>I. Build a basic plant with muscles wrapped around the skeleton<a class="headerlink" href="#I.-Build-a-basic-plant-with-muscles-wrapped-around-the-skeleton" title="Permalink to this headline">#</a></h2>
<p>First, let’s create a skeleton and declare a muscle type. Next, we will the pass these to the to a <a class="reference internal" href="../motornet.plants.html"><span class="doc">Plant</span></a> class or subclass instance to create a plant object. Finally, we can build a muscle system around the skeleton by specifying each muscle one by one, using the base class <code class="docutils literal notranslate"><span class="pre">Plant</span></code> object’s <code class="docutils literal notranslate"><span class="pre">add_muscle</span></code> method. The <code class="docutils literal notranslate"><span class="pre">add_muscle</span></code> method requires at least two arguments:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">path_fixation_body</span></code> should be a list of <em>N</em> integers, with <em>N</em> the number of insertion points of that muscle. Each individual value <em>n</em> of that list indicates the bone that insertion point fixes onto. <em>0</em> always indicates the worldspace, meaning it is not fixed on a bone and so does not move with it. This allows creating “anchor points” for the plant.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">path_coordinates</span></code> should be a list of <em>N</em> lists, each of these lists containing <em>M</em> values - with <em>M</em> the dimensionality of the worldspace. The <em>n</em>th list contains the set of coordinates of the <em>n</em>th insertion point with respect to the origin of the bone it is fixated on, or of the worldspace if it is not fixated on a bone.</p></li>
</ul>
<p>In the example below, we create 4 ReLu muscles connecting to the worldspace with their first fixation point, and to the point mass with their second fixation point.</p>
<p>The muscles are organized as a X-shape according to the illustration below.</p>
<p><img alt="b0feb3d2c88549b0aa838acd36c73baf" class="no-scaled-link" src="../_images/pointmass.png" style="width: 300px;"/></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><br/><span></span><span class="n">skeleton</span> <span class="o">=</span> <span class="n">mn</span><span class="o">.</span><span class="n">plants</span><span class="o">.</span><span class="n">skeletons</span><span class="o">.</span><span class="n">PointMass</span><span class="p">(</span><span class="n">space_dim</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">muscle</span> <span class="o">=</span> <span class="n">mn</span><span class="o">.</span><span class="n">plants</span><span class="o">.</span><span class="n">muscles</span><span class="o">.</span><span class="n">ReluMuscle</span><span class="p">()</span>
<span class="n">point_mass</span> <span class="o">=</span> <span class="n">mn</span><span class="o">.</span><span class="n">plants</span><span class="o">.</span><span class="n">Plant</span><span class="p">(</span><span class="n">skeleton</span><span class="o">=</span><span class="n">skeleton</span><span class="p">,</span> <span class="n">muscle_type</span><span class="o">=</span><span class="n">muscle</span><span class="p">,</span> <span class="n">excitation_noise_sd</span><span class="o">=</span><span class="mi">10</span><span class="o">**-</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># PointMass skeletons only have one "bone", which is the point itself.</span>
<span class="n">point_mass</span><span class="o">.</span><span class="n">add_muscle</span><span class="p">(</span><span class="n">path_fixation_body</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">path_coordinates</span><span class="o">=</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">name</span><span class="o">=</span><span class="s1">'UpRight'</span><span class="p">,</span> <span class="n">max_isometric_force</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">point_mass</span><span class="o">.</span><span class="n">add_muscle</span><span class="p">(</span><span class="n">path_fixation_body</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">path_coordinates</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">name</span><span class="o">=</span><span class="s1">'UpLeft'</span><span class="p">,</span> <span class="n">max_isometric_force</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">point_mass</span><span class="o">.</span><span class="n">add_muscle</span><span class="p">(</span><span class="n">path_fixation_body</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">path_coordinates</span><span class="o">=</span><span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">name</span><span class="o">=</span><span class="s1">'DownRight'</span><span class="p">,</span> <span class="n">max_isometric_force</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">point_mass</span><span class="o">.</span><span class="n">add_muscle</span><span class="p">(</span><span class="n">path_fixation_body</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">path_coordinates</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]],</span> <span class="n">name</span><span class="o">=</span><span class="s1">'DownLeft'</span><span class="p">,</span> <span class="n">max_isometric_force</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<br/><br/></pre></div>
</div>
</div>
<p>Using the muscle paths defined in the <code class="docutils literal notranslate"><span class="pre">add_muscle</span></code> method, the <code class="docutils literal notranslate"><span class="pre">Plant</span></code> class can then determine the moment of each muscle with respect to the joints it spans using geometric first principles. We can visualize this by plotting the moment of each muscle with respect to a dimension as a function of the position of the point mass in the workspace.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><br/><span></span><span class="c1"># create initial conditions</span>
<span class="n">n_states</span> <span class="o">=</span> <span class="mi">21</span>  <span class="c1"># grid resolution</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">point_mass</span><span class="o">.</span><span class="n">pos_lower_bound</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">point_mass</span><span class="o">.</span><span class="n">pos_upper_bound</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">n_states</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'float32'</span><span class="p">),</span>
    <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">point_mass</span><span class="o">.</span><span class="n">pos_lower_bound</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">point_mass</span><span class="o">.</span><span class="n">pos_upper_bound</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">n_states</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'float32'</span><span class="p">))</span>


<span class="c1"># pass the initial joint space to get the full initial states</span>
<span class="c1"># The initial state should be a 4-items list containing:</span>
<span class="c1">#             [joint_state, cartesian_state, muscle_state, geometry_state]</span>

<span class="n">state0</span> <span class="o">=</span> <span class="n">point_mass</span><span class="o">.</span><span class="n">get_initial_state</span><span class="p">(</span><span class="n">joint_state</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">y</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">mstate</span> <span class="o">=</span> <span class="n">state0</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">n_states</span><span class="p">,</span> <span class="n">n_states</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">point_mass</span><span class="o">.</span><span class="n">n_muscles</span><span class="p">))</span>
<span class="n">gstate</span> <span class="o">=</span> <span class="n">state0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">n_states</span><span class="p">,</span> <span class="n">n_states</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">point_mass</span><span class="o">.</span><span class="n">n_muscles</span><span class="p">))</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">25</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="c1"># fig.patch.set_facecolor('xkcd:white')</span>

<span class="k">for</span> <span class="n">muscle</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">point_mass</span><span class="o">.</span><span class="n">n_muscles</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">point_mass</span><span class="o">.</span><span class="n">dof</span><span class="p">):</span>
        <span class="n">subplot</span> <span class="o">=</span> <span class="n">k</span> <span class="o">*</span> <span class="n">point_mass</span><span class="o">.</span><span class="n">n_muscles</span> <span class="o">+</span> <span class="n">muscle</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="n">point_mass</span><span class="o">.</span><span class="n">dof</span><span class="p">,</span> <span class="n">point_mass</span><span class="o">.</span><span class="n">n_muscles</span><span class="p">,</span> <span class="n">subplot</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">'3d'</span><span class="p">)</span>

        <span class="n">z</span> <span class="o">=</span> <span class="n">gstate</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="o">+</span><span class="n">k</span><span class="p">,</span> <span class="n">muscle</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span>  <span class="c1"># m to cm</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">'coolwarm'</span><span class="p">))</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'x (cm)'</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'y (cm)'</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">'moment (cm)'</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">point_mass</span><span class="o">.</span><span class="n">muscle_name</span><span class="p">[</span><span class="n">muscle</span><span class="p">]</span> <span class="o">+</span> <span class="s2">" muscle"</span><span class="p">)</span>

        <span class="c1"># adjust angle of view</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">muscle</span><span class="o">==</span><span class="mi">0</span> <span class="ow">or</span> <span class="n">muscle</span><span class="o">==</span><span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">40</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
          <span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="o">-</span><span class="mi">40</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">locator_params</span><span class="p">(</span><span class="n">nbins</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.085</span><span class="p">,</span> <span class="mf">0.7</span><span class="p">,</span> <span class="s1">'Moment w.r.t X-dimension'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">'vertical'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">'x-large'</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.085</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="s1">'Moment w.r.t Y-dimension'</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">'center'</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="s1">'vertical'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="s1">'x-large'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_1-build-plant_6_0.png" src="../_images/tutorials_1-build-plant_6_0.png"/>
</div>
</div>
</section>
<section id="II.-A-more-complex-plant-system:-arm210">
<h2>II. A more complex plant system: arm210<a class="headerlink" href="#II.-A-more-complex-plant-system:-arm210" title="Permalink to this headline">#</a></h2>
<p>Now we will create a more complex plant, that uses a 2-DOF arm skeleton and a rigid-tendon Hill muscle. We then build a muscle system containing 10 muscles inserted in various ways across each bone.</p>
<section id="1.-building-the-plant">
<h3>1. building the plant<a class="headerlink" href="#1.-building-the-plant" title="Permalink to this headline">#</a></h3>
<p>The coordinate system works according to the illustation below. The first coordinate of an insertion point is always in the direction of the bone that point is fixed on, and the second coordinate indicates the deviation perpendicular to that bone’s direction.</p>
<p><img alt="drawing" class="no-scaled-link" src="../_images/arm210.png" style="width: 500px;"/></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><br/><br/><span></span><span class="n">arm210</span> <span class="o">=</span> <span class="n">mn</span><span class="o">.</span><span class="n">plants</span><span class="o">.</span><span class="n">Plant</span><span class="p">(</span>
  <span class="n">skeleton</span><span class="o">=</span><span class="n">mn</span><span class="o">.</span><span class="n">plants</span><span class="o">.</span><span class="n">skeletons</span><span class="o">.</span><span class="n">TwoDofArm</span><span class="p">(),</span>
  <span class="n">muscle_type</span><span class="o">=</span><span class="n">mn</span><span class="o">.</span><span class="n">plants</span><span class="o">.</span><span class="n">muscles</span><span class="o">.</span><span class="n">RigidTendonHillMuscleThelen</span><span class="p">())</span>

<span class="n">arm210</span><span class="o">.</span><span class="n">add_muscle</span><span class="p">(</span>
  <span class="n">path_fixation_body</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
  <span class="n">path_coordinates</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mf">.15</span><span class="p">,</span> <span class="mf">.03</span><span class="p">],</span> <span class="p">[</span><span class="mf">.094</span><span class="p">,</span> <span class="mf">0.017</span><span class="p">]],</span>
  <span class="n">name</span><span class="o">=</span><span class="s1">'pectoralis'</span><span class="p">,</span>
  <span class="n">max_isometric_force</span><span class="o">=</span><span class="mi">838</span><span class="p">,</span>
  <span class="n">tendon_length</span><span class="o">=</span><span class="mf">.039</span><span class="p">,</span>
  <span class="n">optimal_muscle_length</span><span class="o">=</span><span class="mf">.134</span><span class="p">,</span>
  <span class="n">normalized_slack_muscle_length</span><span class="o">=</span><span class="mf">1.48</span><span class="p">)</span>

<span class="n">arm210</span><span class="o">.</span><span class="n">add_muscle</span><span class="p">(</span>
  <span class="n">path_fixation_body</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
  <span class="n">path_coordinates</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mf">.034</span><span class="p">,</span> <span class="mf">.022</span><span class="p">],</span> <span class="p">[</span><span class="mf">.144</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]],</span>
  <span class="n">name</span><span class="o">=</span><span class="s1">'clavicular deltoid'</span><span class="p">,</span>
  <span class="n">max_isometric_force</span><span class="o">=</span><span class="mi">680</span><span class="p">,</span>
  <span class="n">tendon_length</span><span class="o">=</span><span class="mf">.039</span><span class="p">,</span>
  <span class="n">optimal_muscle_length</span><span class="o">=</span><span class="mf">.104</span><span class="p">,</span>
  <span class="n">normalized_slack_muscle_length</span><span class="o">=</span><span class="mf">1.4</span><span class="p">)</span>

<span class="n">arm210</span><span class="o">.</span><span class="n">add_muscle</span><span class="p">(</span>
  <span class="n">path_fixation_body</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
  <span class="n">path_coordinates</span><span class="o">=</span><span class="p">[[</span><span class="mf">.14</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">.05</span><span class="p">,</span> <span class="o">-</span><span class="mf">.00</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.153</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]],</span>
  <span class="n">name</span><span class="o">=</span><span class="s1">'deltoid'</span><span class="p">,</span>
  <span class="n">max_isometric_force</span><span class="o">=</span><span class="mi">1207</span><span class="p">,</span>
  <span class="n">tendon_length</span><span class="o">=</span><span class="mf">.066</span><span class="p">,</span>
  <span class="n">optimal_muscle_length</span><span class="o">=</span><span class="mf">.140</span><span class="p">,</span>
  <span class="n">normalized_slack_muscle_length</span><span class="o">=</span><span class="mf">1.52</span><span class="p">)</span>

<span class="n">arm210</span><span class="o">.</span><span class="n">add_muscle</span><span class="p">(</span>
  <span class="n">path_fixation_body</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span>
  <span class="n">path_coordinates</span><span class="o">=</span><span class="p">[[</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">.05</span><span class="p">,</span> <span class="o">-</span><span class="mf">.03</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.062</span><span class="p">,</span> <span class="mf">0.004</span><span class="p">]],</span>
  <span class="n">name</span><span class="o">=</span><span class="s1">'teres major'</span><span class="p">,</span>
  <span class="n">max_isometric_force</span><span class="o">=</span><span class="mi">1207</span><span class="p">,</span>
  <span class="n">tendon_length</span><span class="o">=</span><span class="mf">.066</span><span class="p">,</span>
  <span class="n">optimal_muscle_length</span><span class="o">=</span><span class="mf">.068</span><span class="p">,</span>
  <span class="n">normalized_slack_muscle_length</span><span class="o">=</span><span class="mf">1.65</span><span class="p">)</span>

<span class="n">arm210</span><span class="o">.</span><span class="n">add_muscle</span><span class="p">(</span>
  <span class="n">path_fixation_body</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span>
  <span class="n">path_coordinates</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.23</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.231</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]],</span>
  <span class="n">name</span><span class="o">=</span><span class="s1">'brachioradialis'</span><span class="p">,</span>
  <span class="n">max_isometric_force</span><span class="o">=</span><span class="mi">1422</span><span class="p">,</span>
  <span class="n">tendon_length</span><span class="o">=</span><span class="mf">.172</span><span class="p">,</span>
  <span class="n">optimal_muscle_length</span><span class="o">=</span><span class="mf">.092</span><span class="p">,</span>
  <span class="n">normalized_slack_muscle_length</span><span class="o">=</span><span class="mf">1.43</span><span class="p">)</span>

<span class="n">arm210</span><span class="o">.</span><span class="n">add_muscle</span><span class="p">(</span>
  <span class="n">path_fixation_body</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span>
  <span class="n">path_coordinates</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.03</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.138</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.019</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.04</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.017</span><span class="p">]],</span>
  <span class="n">name</span><span class="o">=</span><span class="s1">'tricepslat'</span><span class="p">,</span>
  <span class="n">max_isometric_force</span><span class="o">=</span><span class="mi">1549</span><span class="p">,</span>
  <span class="n">tendon_length</span><span class="o">=</span><span class="mf">.187</span><span class="p">,</span>
  <span class="n">optimal_muscle_length</span><span class="o">=</span><span class="mf">.093</span><span class="p">,</span>
  <span class="n">normalized_slack_muscle_length</span><span class="o">=</span><span class="mf">1.45</span><span class="p">)</span>

<span class="n">arm210</span><span class="o">.</span><span class="n">add_muscle</span><span class="p">(</span>
  <span class="n">path_fixation_body</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span>
  <span class="n">path_coordinates</span><span class="o">=</span><span class="p">[[</span><span class="o">-</span><span class="mf">0.052</span><span class="p">,</span> <span class="mf">0.033</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.044</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">]],</span>
  <span class="n">name</span><span class="o">=</span><span class="s1">'biceps'</span><span class="p">,</span>
  <span class="n">max_isometric_force</span><span class="o">=</span><span class="mi">414</span><span class="p">,</span>
  <span class="n">tendon_length</span><span class="o">=</span><span class="mf">.204</span><span class="p">,</span>
  <span class="n">optimal_muscle_length</span><span class="o">=</span><span class="mf">.137</span><span class="p">,</span>
  <span class="n">normalized_slack_muscle_length</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>

<span class="n">arm210</span><span class="o">.</span><span class="n">add_muscle</span><span class="p">(</span>
  <span class="n">path_fixation_body</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span>
  <span class="n">path_coordinates</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.02</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.028</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mf">0.04</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.017</span><span class="p">]],</span>
  <span class="n">name</span><span class="o">=</span><span class="s1">'tricepslong'</span><span class="p">,</span>
  <span class="n">max_isometric_force</span><span class="o">=</span><span class="mi">603</span><span class="p">,</span>
  <span class="n">tendon_length</span><span class="o">=</span><span class="mf">0.217</span><span class="p">,</span>
  <span class="n">optimal_muscle_length</span><span class="o">=</span><span class="mf">0.127</span><span class="p">,</span>
  <span class="n">normalized_slack_muscle_length</span><span class="o">=</span><span class="mf">1.4</span><span class="p">)</span>

<span class="n">arm210</span><span class="o">.</span><span class="n">add_muscle</span><span class="p">(</span>
  <span class="n">path_fixation_body</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span>
  <span class="n">path_coordinates</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.306</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.011</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.003</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.025</span><span class="p">]],</span>
  <span class="n">name</span><span class="o">=</span><span class="s1">'anconeus'</span><span class="p">,</span>
  <span class="n">max_isometric_force</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
  <span class="n">tendon_length</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span>
  <span class="n">optimal_muscle_length</span><span class="o">=</span><span class="mf">0.015</span><span class="p">,</span>
  <span class="n">normalized_slack_muscle_length</span><span class="o">=</span><span class="mf">1.72</span><span class="p">)</span>

<span class="n">arm210</span><span class="o">.</span><span class="n">add_muscle</span><span class="p">(</span>
  <span class="n">path_fixation_body</span><span class="o">=</span><span class="p">[</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">],</span>
  <span class="n">path_coordinates</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.277</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.075</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">]],</span>
  <span class="n">name</span><span class="o">=</span><span class="s1">'prot'</span><span class="p">,</span>
  <span class="n">max_isometric_force</span><span class="o">=</span><span class="mi">700</span><span class="p">,</span>
  <span class="n">tendon_length</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span>
  <span class="n">optimal_muscle_length</span><span class="o">=</span><span class="mf">0.058</span><span class="p">,</span>
  <span class="n">normalized_slack_muscle_length</span><span class="o">=</span><span class="mf">1.48</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">'Plant built.'</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Plant built.
</pre></div></div>
</div>
</section>
<section id="2.-Visualizing-moment-arms">
<h3>2. Visualizing moment arms<a class="headerlink" href="#2.-Visualizing-moment-arms" title="Permalink to this headline">#</a></h3>
<p>Now we can visualize the moment of each muscle with respect to joint angles. Note that there are two surfaces per plot, one for the moment of the shoulder joint and one for the moment of the elbow joint. If a muscle does not span a joint, its moment arm will always be <em>0</em> regardless of the skeleton’s joint configuration. In other words, if that muscle shortens or lengthens, it would alter the angle of the joint by <em>0</em>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><br/><span></span><span class="c1"># create a grid of joint angles</span>
<span class="n">n_states</span> <span class="o">=</span> <span class="mi">21</span>  <span class="c1"># grid resolution</span>
<span class="n">sho</span><span class="p">,</span> <span class="n">elb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">arm210</span><span class="o">.</span><span class="n">pos_lower_bound</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">arm210</span><span class="o">.</span><span class="n">pos_upper_bound</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">n_states</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'float32'</span><span class="p">),</span>
    <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">arm210</span><span class="o">.</span><span class="n">pos_lower_bound</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">arm210</span><span class="o">.</span><span class="n">pos_upper_bound</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">n_states</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'float32'</span><span class="p">))</span>

<span class="n">state0</span> <span class="o">=</span> <span class="n">arm210</span><span class="o">.</span><span class="n">get_initial_state</span><span class="p">(</span><span class="n">joint_state</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">sho</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">elb</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">mstate</span> <span class="o">=</span> <span class="n">state0</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">n_states</span><span class="p">,</span> <span class="n">n_states</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">arm210</span><span class="o">.</span><span class="n">n_muscles</span><span class="p">))</span>
<span class="n">gstate</span> <span class="o">=</span> <span class="n">state0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">n_states</span><span class="p">,</span> <span class="n">n_states</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">arm210</span><span class="o">.</span><span class="n">n_muscles</span><span class="p">))</span>


<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">'xkcd:white'</span><span class="p">)</span>
<span class="c1"># fig.set_tight_layout(True)</span>
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">arm210</span><span class="o">.</span><span class="n">n_muscles</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">'3d'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">sho</span><span class="p">,</span> <span class="n">elb</span><span class="p">,</span> <span class="n">gstate</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">'coolwarm'</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">sho</span><span class="p">,</span> <span class="n">elb</span><span class="p">,</span> <span class="n">gstate</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">'coolwarm'</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'shoulder angle (rad)'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'elbow angle (rad)'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">'moment arm (cm)'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="o">-</span><span class="mi">40</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">locator_params</span><span class="p">(</span><span class="n">nbins</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">arm210</span><span class="o">.</span><span class="n">muscle_name</span><span class="p">[</span><span class="n">m</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_1-build-plant_11_0.png" src="../_images/tutorials_1-build-plant_11_0.png"/>
</div>
</div>
</section>
<section id="3.-Visualizing-muscle-lengths">
<h3>3. Visualizing muscle lengths<a class="headerlink" href="#3.-Visualizing-muscle-lengths" title="Permalink to this headline">#</a></h3>
<p>We can also visualize each muscle’s length as a function of joint angle.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><br/><span></span><span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">25</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">fig</span><span class="o">.</span><span class="n">patch</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">'xkcd:white'</span><span class="p">)</span>
<span class="c1"># fig.set_tight_layout(True)</span>
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">arm210</span><span class="o">.</span><span class="n">n_muscles</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">'3d'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">sho</span><span class="p">,</span> <span class="n">elb</span><span class="p">,</span> <span class="n">mstate</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">'coolwarm'</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'shoulder angle (rad)'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'elbow angle (rad)'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">'muscle length (m)'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="o">-</span><span class="mi">40</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">locator_params</span><span class="p">(</span><span class="n">nbins</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">arm210</span><span class="o">.</span><span class="n">muscle_name</span><span class="p">[</span><span class="n">m</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_1-build-plant_13_0.png" src="../_images/tutorials_1-build-plant_13_0.png"/>
</div>
</div>
</section>
</section>
<section id="III.-Pre-built-subclasses">
<h2>III. Pre-built subclasses<a class="headerlink" href="#III.-Pre-built-subclasses" title="Permalink to this headline">#</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">motornet</span></code> comes with pre-built subclasses for most objects, including <code class="docutils literal notranslate"><span class="pre">Plant</span></code> objects. One of those <code class="docutils literal notranslate"><span class="pre">Plant</span></code> subclasses is <code class="docutils literal notranslate"><span class="pre">RigidTendonArm26</span></code>, a 2-DOF, 6-muscles plant that overwrites the default geometry (muscle length, velocity, and moment arm) calculation with its own method. That method approximates muscle length and velocity using a third-degree polynomial approximation function, and assumes linearly varying moment arms. The full-blown model is detailed in <a class="reference external" href="https://www.physiology.org/doi/10.1152/jn.00983.2005">Kistemaker et al.,
2006</a> and <a class="reference external" href="https://www.physiology.org/doi/10.1152/jn.00483.2010">Kistemaker et al., 2010</a>.</p>
<section id="1.-Moment-arms-and-muscle-lengths">
<h3>1. Moment arms and muscle lengths<a class="headerlink" href="#1.-Moment-arms-and-muscle-lengths" title="Permalink to this headline">#</a></h3>
<p>We can plot muscle lengths and moment arms for the <code class="docutils literal notranslate"><span class="pre">RigidTendonArm26</span></code> subclass similar to the previous <code class="docutils literal notranslate"><span class="pre">Plant</span></code> examples above to observe that the subclass returns the adjusted geometry properly.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><br/><span></span><span class="c1">#---------</span>
<span class="c1"># create plant instance</span>
<span class="c1">#---------</span>
<span class="n">arm26</span> <span class="o">=</span> <span class="n">mn</span><span class="o">.</span><span class="n">plants</span><span class="o">.</span><span class="n">RigidTendonArm26</span><span class="p">(</span><span class="n">muscle_type</span><span class="o">=</span><span class="n">mn</span><span class="o">.</span><span class="n">plants</span><span class="o">.</span><span class="n">muscles</span><span class="o">.</span><span class="n">RigidTendonHillMuscleThelen</span><span class="p">())</span>


<span class="c1">#---------</span>
<span class="c1"># get geometry</span>
<span class="c1">#---------</span>
<span class="n">sho</span><span class="p">,</span> <span class="n">elb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span>
  <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">arm26</span><span class="o">.</span><span class="n">pos_lower_bound</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">arm26</span><span class="o">.</span><span class="n">pos_upper_bound</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">n_states</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'float32'</span><span class="p">),</span>
  <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">arm26</span><span class="o">.</span><span class="n">pos_lower_bound</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">arm26</span><span class="o">.</span><span class="n">pos_upper_bound</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">n_states</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'float32'</span><span class="p">))</span>
<span class="n">state0</span> <span class="o">=</span> <span class="n">arm26</span><span class="o">.</span><span class="n">get_initial_state</span><span class="p">(</span><span class="n">joint_state</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">sho</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">elb</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">gstate</span> <span class="o">=</span> <span class="n">state0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">n_states</span><span class="p">,</span> <span class="n">n_states</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">arm26</span><span class="o">.</span><span class="n">n_muscles</span><span class="p">))</span>
<span class="n">mstate</span> <span class="o">=</span> <span class="n">state0</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">n_states</span><span class="p">,</span> <span class="n">n_states</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">arm26</span><span class="o">.</span><span class="n">n_muscles</span><span class="p">))</span>


<span class="c1">#---------</span>
<span class="c1"># plot moment arms</span>
<span class="c1">#---------</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="c1"># fig.patch.set_facecolor('xkcd:white')</span>
<span class="c1"># fig.set_tight_layout(True)</span>
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">arm26</span><span class="o">.</span><span class="n">n_muscles</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">'3d'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">sho</span><span class="p">,</span> <span class="n">elb</span><span class="p">,</span> <span class="n">gstate</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">'coolwarm'</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">sho</span><span class="p">,</span> <span class="n">elb</span><span class="p">,</span> <span class="n">gstate</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">'coolwarm'</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'shoulder angle (rad)'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'elbow angle (rad)'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">'moment arm (cm)'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="o">-</span><span class="mi">40</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">locator_params</span><span class="p">(</span><span class="n">nbins</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">arm26</span><span class="o">.</span><span class="n">muscle_name</span><span class="p">[</span><span class="n">m</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_1-build-plant_15_0.png" src="../_images/tutorials_1-build-plant_15_0.png"/>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><br/><span></span><span class="c1">#---------</span>
<span class="c1"># plot muscle lengths</span>
<span class="c1">#---------</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="c1"># fig.patch.set_facecolor('xkcd:white')</span>
<span class="c1"># fig.set_tight_layout(True)</span>
<span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">arm26</span><span class="o">.</span><span class="n">n_muscles</span><span class="p">):</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">'3d'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">sho</span><span class="p">,</span> <span class="n">elb</span><span class="p">,</span> <span class="n">mstate</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">],</span> <span class="n">cmap</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="s1">'coolwarm'</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'shoulder angle (rad)'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'elbow angle (rad)'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">'muscle length (m)'</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="o">-</span><span class="mi">40</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">locator_params</span><span class="p">(</span><span class="n">nbins</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">arm26</span><span class="o">.</span><span class="n">muscle_name</span><span class="p">[</span><span class="n">m</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_1-build-plant_16_0.png" src="../_images/tutorials_1-build-plant_16_0.png"/>
</div>
</div>
</section>
<section id="2.-Example-of-drift-from-passive-forces-in-Hill-type-muscles">
<h3>2. Example of drift from passive forces in Hill-type muscles<a class="headerlink" href="#2.-Example-of-drift-from-passive-forces-in-Hill-type-muscles" title="Permalink to this headline">#</a></h3>
<p>Hill-type muscles like implemented in <code class="docutils literal notranslate"><span class="pre">RigidTendonHillMuscle</span></code> produce passive forces when stretched beyond a certain threshold. This should lead the arm to experience small re-centering forces at the edge of its joint space. We can observe these forces by running a simulation across the workspace and observe the positional drift in the absence of active input to the plant.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><br/><span></span><span class="n">n_states</span> <span class="o">=</span> <span class="mi">21</span>

<span class="n">sho</span><span class="p">,</span> <span class="n">elb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">arm26</span><span class="o">.</span><span class="n">pos_lower_bound</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">arm26</span><span class="o">.</span><span class="n">pos_upper_bound</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">n_states</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'float32'</span><span class="p">),</span>
    <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">arm26</span><span class="o">.</span><span class="n">pos_lower_bound</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">arm26</span><span class="o">.</span><span class="n">pos_upper_bound</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">n_states</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">'float32'</span><span class="p">))</span>
<span class="n">excitation</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">sho</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">arm26</span><span class="o">.</span><span class="n">n_muscles</span><span class="p">))</span>


<span class="c1">#-------</span>
<span class="c1"># 200 ms simulation to assess drift</span>
<span class="c1">#-------</span>
<span class="n">states</span> <span class="o">=</span> <span class="n">arm26</span><span class="o">.</span><span class="n">get_initial_state</span><span class="p">(</span><span class="n">joint_state</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">sho</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">elb</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">c_results</span> <span class="o">=</span> <span class="n">states</span><span class="p">[</span><span class="mi">1</span><span class="p">][:,</span> <span class="n">tf</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]</span>

<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="mf">0.2</span> <span class="o">/</span> <span class="n">arm26</span><span class="o">.</span><span class="n">dt</span><span class="p">)):</span>
  <span class="n">joint_state</span><span class="p">,</span> <span class="n">cartesian_state</span><span class="p">,</span> <span class="n">muscle_state</span><span class="p">,</span> <span class="n">geometry_state</span> <span class="o">=</span> <span class="n">states</span>
  <span class="n">states</span> <span class="o">=</span> <span class="n">arm26</span><span class="p">(</span><span class="n">excitation</span><span class="p">,</span> <span class="n">joint_state</span><span class="p">,</span> <span class="n">muscle_state</span><span class="p">,</span> <span class="n">geometry_state</span><span class="p">)</span>
  <span class="n">c_results</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">c_results</span><span class="p">,</span> <span class="n">states</span><span class="p">[</span><span class="mi">1</span><span class="p">][:,</span> <span class="n">tf</span><span class="o">.</span><span class="n">newaxis</span><span class="p">,</span> <span class="p">:]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># plot results</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span><span class="o">.</span><span class="n">set_tight_layout</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">mn</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">plotor</span><span class="o">.</span><span class="n">plot_pos_over_time</span><span class="p">(</span><span class="n">cart_results</span><span class="o">=</span><span class="n">c_results</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">'drift from passive muscle forces alone'</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_1-build-plant_18_0.png" src="../_images/tutorials_1-build-plant_18_0.png"/>
</div>
</div>
</section>
</section>
<section id="IV.-Numerical-integration">
<h2>IV. Numerical integration<a class="headerlink" href="#IV.-Numerical-integration" title="Permalink to this headline">#</a></h2>
<p>While muscle and skeleton dynamics are solved via ordinary differential equations (ODEs) held at the level of the <code class="docutils literal notranslate"><span class="pre">Muscle</span></code> and <code class="docutils literal notranslate"><span class="pre">Skeleton</span></code> objects, numerical integration is actually handled by the <code class="docutils literal notranslate"><span class="pre">Plant</span></code> object. This allows integrating both the muscle and skeleton systems at the same time, thereby reducing numerical instability.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">Plant</span></code> object allows for numerical integration via Euler and Runge-Kutta 4 methods, with Euler being the default method. This is usually sufficient for most simulation work, although some more complex simulations may benefit fro switching to Runge-Kutta 4. It is always recommended to visualize muscle and skeleton dynamics to ensure one’s system does not display unstable behaviour.</p>
<p>Below we briefly illustrate the difference between each integration method in the context of <code class="docutils literal notranslate"><span class="pre">motornet</span></code> simulations.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">integrate_activation</span><span class="p">(</span><span class="n">plant</span><span class="p">,</span> <span class="n">excitation_pattern</span><span class="p">,</span> <span class="n">movement_duration</span><span class="p">,</span> <span class="n">initial_value</span><span class="p">):</span>
    <span class="n">t_fn</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">movement_duration</span><span class="p">,</span> <span class="n">plant</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span>

    <span class="n">js</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ms</span><span class="p">,</span> <span class="n">gs</span> <span class="o">=</span> <span class="n">plant</span><span class="o">.</span><span class="n">get_initial_state</span><span class="p">(</span><span class="n">joint_state</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">)))</span>
    <span class="n">ms</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">plant</span><span class="o">.</span><span class="n">n_muscles</span><span class="p">))</span> <span class="o">*</span> <span class="n">initial_value</span><span class="p">,</span> <span class="n">ms</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">:,</span> <span class="p">:]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="n">m_states</span> <span class="o">=</span> <span class="n">ms</span>
    <span class="n">inputs</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">plant</span><span class="o">.</span><span class="n">n_muscles</span><span class="p">))</span> <span class="o">*</span> <span class="n">excitation_pattern</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">t_fn</span><span class="p">)):</span>
        <span class="n">js</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">ms</span><span class="p">,</span> <span class="n">gs</span> <span class="o">=</span> <span class="n">plant</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">js</span><span class="p">,</span> <span class="n">ms</span><span class="p">,</span> <span class="n">gs</span><span class="p">)</span>
        <span class="n">m_states</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">m_states</span><span class="p">,</span> <span class="n">ms</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">m_states</span>


<span class="k">def</span> <span class="nf">plot_integration</span><span class="p">(</span><span class="n">plant</span><span class="p">,</span> <span class="n">title</span><span class="p">):</span>
  <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="s1">'all'</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="s1">'all'</span><span class="p">)</span>
  <span class="n">fig</span><span class="o">.</span><span class="n">set_tight_layout</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
  <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">((</span><span class="mi">11</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

  <span class="n">mvt_dur</span> <span class="o">=</span> <span class="mf">0.25</span>
  <span class="n">xticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">mvt_dur</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">mvt_dur</span> <span class="o">/</span> <span class="n">plant</span><span class="o">.</span><span class="n">dt</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="mi">1000</span>  <span class="c1"># sec to ms</span>

  <span class="n">ms</span> <span class="o">=</span> <span class="n">integrate_activation</span><span class="p">(</span><span class="n">plant</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">mvt_dur</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
  <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'grey'</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">':'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'excitation'</span><span class="p">)</span>
  <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xticks</span><span class="p">,</span> <span class="n">ms</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">'activation'</span><span class="p">)</span>
  <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">'activation (a.u.)'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
  <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

  <span class="n">ms</span> <span class="o">=</span> <span class="n">integrate_activation</span><span class="p">(</span><span class="n">plant</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">mvt_dur</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
  <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'grey'</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">':'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'excitation'</span><span class="p">)</span>
  <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xticks</span><span class="p">,</span> <span class="n">ms</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">'activation'</span><span class="p">)</span>
  <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">'time (ms)'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>

  <span class="n">ms</span> <span class="o">=</span> <span class="n">integrate_activation</span><span class="p">(</span><span class="n">plant</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">mvt_dur</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
  <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">'grey'</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">':'</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">'excitation'</span><span class="p">)</span>
  <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xticks</span><span class="p">,</span> <span class="n">ms</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">'activation'</span><span class="p">)</span>

  <span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>



<span class="n">muscle_type</span> <span class="o">=</span> <span class="n">mn</span><span class="o">.</span><span class="n">plants</span><span class="o">.</span><span class="n">muscles</span><span class="o">.</span><span class="n">RigidTendonHillMuscleThelen</span><span class="p">()</span>

<span class="n">arm26</span> <span class="o">=</span> <span class="n">mn</span><span class="o">.</span><span class="n">plants</span><span class="o">.</span><span class="n">RigidTendonArm26</span><span class="p">(</span><span class="n">muscle_type</span><span class="o">=</span><span class="n">muscle_type</span><span class="p">)</span>
<span class="n">plot_integration</span><span class="p">(</span><span class="n">arm26</span><span class="p">,</span> <span class="s1">'muscle activation ODE (Euler method, dt = 0.01)'</span><span class="p">)</span>

<span class="n">arm26</span> <span class="o">=</span> <span class="n">mn</span><span class="o">.</span><span class="n">plants</span><span class="o">.</span><span class="n">RigidTendonArm26</span><span class="p">(</span><span class="n">muscle_type</span><span class="o">=</span><span class="n">muscle_type</span><span class="p">,</span> <span class="n">timestep</span><span class="o">=</span><span class="mf">0.001</span><span class="p">)</span>
<span class="n">plot_integration</span><span class="p">(</span><span class="n">arm26</span><span class="p">,</span> <span class="s1">'muscle activation ODE (Euler method, dt = 0.001)'</span><span class="p">)</span>

<span class="n">arm26</span> <span class="o">=</span> <span class="n">mn</span><span class="o">.</span><span class="n">plants</span><span class="o">.</span><span class="n">RigidTendonArm26</span><span class="p">(</span><span class="n">muscle_type</span><span class="o">=</span><span class="n">muscle_type</span><span class="p">,</span> <span class="n">integration_method</span><span class="o">=</span><span class="s1">'rk4'</span><span class="p">)</span>
<span class="n">plot_integration</span><span class="p">(</span><span class="n">arm26</span><span class="p">,</span> <span class="s1">'muscle activation ODE (Runge-Kutta-4 method, dt = 0.01)'</span><span class="p">)</span>
<br/><br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_1-build-plant_20_0.png" src="../_images/tutorials_1-build-plant_20_0.png"/>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_1-build-plant_20_1.png" src="../_images/tutorials_1-build-plant_20_1.png"/>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/tutorials_1-build-plant_20_2.png" src="../_images/tutorials_1-build-plant_20_2.png"/>
</div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../md/tutorial1.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">How to do foo</div>
              </div>
              <svg><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../motornet.task.html">
              <svg><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">motornet.task</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2022, Olivier Codol
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            Contents
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Build a plant</a><ul>
<li><a class="reference internal" href="#I.-Build-a-basic-plant-with-muscles-wrapped-around-the-skeleton">I. Build a basic plant with muscles wrapped around the skeleton</a></li>
<li><a class="reference internal" href="#II.-A-more-complex-plant-system:-arm210">II. A more complex plant system: arm210</a><ul>
<li><a class="reference internal" href="#1.-building-the-plant">1. building the plant</a></li>
<li><a class="reference internal" href="#2.-Visualizing-moment-arms">2. Visualizing moment arms</a></li>
<li><a class="reference internal" href="#3.-Visualizing-muscle-lengths">3. Visualizing muscle lengths</a></li>
</ul>
</li>
<li><a class="reference internal" href="#III.-Pre-built-subclasses">III. Pre-built subclasses</a><ul>
<li><a class="reference internal" href="#1.-Moment-arms-and-muscle-lengths">1. Moment arms and muscle lengths</a></li>
<li><a class="reference internal" href="#2.-Example-of-drift-from-passive-forces-in-Hill-type-muscles">2. Example of drift from passive forces in Hill-type muscles</a></li>
</ul>
</li>
<li><a class="reference internal" href="#IV.-Numerical-integration">IV. Numerical integration</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/furo.js"></script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    </body>
</html>